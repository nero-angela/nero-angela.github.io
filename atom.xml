<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>🐈 Nero&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://nero.devstory.co.kr/"/>
  <updated>2019-11-10T09:54:39.574Z</updated>
  <id>https://nero.devstory.co.kr/</id>
  
  <author>
    <name>Nero</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python Itertools</title>
    <link href="https://nero.devstory.co.kr/2019/11/09/pl-python-itertools/"/>
    <id>https://nero.devstory.co.kr/2019/11/09/pl-python-itertools/</id>
    <published>2019-11-09T09:47:24.000Z</published>
    <updated>2019-11-10T09:54:39.574Z</updated>
    
    <content type="html"><![CDATA[<!-- one line summary --><h1 id="Itertools"><a href="#Itertools" class="headerlink" title="# Itertools"></a># Itertools</h1><p>이번 포스팅에서는 Python 2.7과 3.5부터 탑제된 <code>itertools</code>의 유용하고 자주 쓸만한 함수들을 익혀보도록 하겠습니다.<br><a id="more"></a></p><blockquote><p><strong>1. Iterators terminating on the shortest input sequence</strong></p></blockquote><ul><li><input checked disabled type="checkbox"> <a href="#accumulate">1.1 accumulate</a></li><li><input checked disabled type="checkbox"> <a href="#compress">1.2 compress</a></li><li><input checked disabled type="checkbox"> <a href="#dropwhile">1.3 dropwhile</a></li><li><input checked disabled type="checkbox"> <a href="#groupby">1.4 groupby</a></li><li><input checked disabled type="checkbox"> <a href="#takewhile">1.5 takewhile</a></li><li><input checked disabled type="checkbox"> <a href="#zip_longest">1.6 zip_longest</a></li></ul><blockquote><p><strong>2. Combinatoric iterators</strong></p></blockquote><ul><li><input checked disabled type="checkbox"> <a href="#product">2.1 product</a></li><li><input checked disabled type="checkbox"> <a href="#permutations">2.2 permutations</a></li><li><input checked disabled type="checkbox"> <a href="#combinations">2.3 combinations</a></li><li><input checked disabled type="checkbox"> <a href="#combinations_with_replacement">2.4 combinations_with_replacement</a></li></ul><p>시작하기에 앞서 다음과 같이 <code>itertools</code> 모듈을 import하여, 이후 코드에서는 <code>it</code>라고 사용하겠습니다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools <span class="keyword">as</span> it</span><br></pre></td></tr></table></figure><hr><h1 id="1-Iterators-terminating-on-the-shortest-input-sequence"><a href="#1-Iterators-terminating-on-the-shortest-input-sequence" class="headerlink" title="1. Iterators terminating on the shortest input sequence"></a>1. Iterators terminating on the shortest input sequence</h1><hr><h2 id="1-1-accumulate-🔗"><a href="#1-1-accumulate-🔗" class="headerlink" title="1.1 accumulate 🔗 "></a>1.1 accumulate <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.accumulate" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="accumulate"></a></h2><blockquote><p>배열을 받아, 누적 합으로 이루어진 배열을 반환합니다.<br>(기본적으로 sum을 하나, 별도의 operator function을 인자로 줄 수 있습니다.)</p></blockquote><p>python3.8에서는 initial 인자가 추가되었습니다.</p><figure class="highlight python"><figcaption><span>python 버전 별 accumulate 함수</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3.8</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">accumulate</span><span class="params">(iterable, func=operator.add, *, initial=None)</span>:</span></span><br><span class="line">    it = iter(iterable)</span><br><span class="line">    total = initial</span><br><span class="line">    <span class="keyword">if</span> initial <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            total = next(it)</span><br><span class="line">        <span class="keyword">except</span> StopIteration:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">yield</span> total</span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> it:</span><br><span class="line">        total = func(total, element)</span><br><span class="line">        <span class="keyword">yield</span> total</span><br><span class="line"></span><br><span class="line"><span class="comment"># python 3.7 이하</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">accumulate</span><span class="params">(iterable, func=operator.add)</span>:</span></span><br><span class="line">    it = iter(iterable)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        total = next(it)</span><br><span class="line">    <span class="keyword">except</span> StopIteration:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">yield</span> total</span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> it:</span><br><span class="line">        total = func(total, element)</span><br><span class="line">        <span class="keyword">yield</span> total</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>자연수 배열 예제입니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.accumulate([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">1  # 1</span></span><br><span class="line"><span class="string">3  # 1 + 2</span></span><br><span class="line"><span class="string">6  # 1 + 2 + 3</span></span><br><span class="line"><span class="string">10 # 1 + 2 + 3 + 4</span></span><br><span class="line"><span class="string">15 # 1 + 2 + 3 + 4 + 5</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>숫자 뿐만 아니라 문자열도 연산 가능합니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.accumulate([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>]):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">a</span></span><br><span class="line"><span class="string">ab</span></span><br><span class="line"><span class="string">abc</span></span><br><span class="line"><span class="string">abcd</span></span><br><span class="line"><span class="string">abcde</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>다른 함수를 인자로 주어 다양한 연산도 가능합니다.</p><figure class="highlight python"><figcaption><span>operator의 곱하기 합수를 주었습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> operator <span class="keyword">as</span> op</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.accumulate([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], op.mul):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">1   # 1</span></span><br><span class="line"><span class="string">2   # 1 * 2</span></span><br><span class="line"><span class="string">6   # 1 * 2 * 3</span></span><br><span class="line"><span class="string">24  # 1 * 2 * 3 * 4</span></span><br><span class="line"><span class="string">120 # 1 * 2 * 3 * 4 * 5</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>max 함수를 이용하여 다음과 같은 연산도 가능합니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.accumulate([<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">7</span>], max):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">8</span></span><br><span class="line"><span class="string">8</span></span><br><span class="line"><span class="string">8</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="1-2-compress-🔗"><a href="#1-2-compress-🔗" class="headerlink" title="1.2 compress 🔗 "></a>1.2 compress <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.compress" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="compress"></a></h2><blockquote><p>문자열과 True/False 배열을 받아서, True인 인덱스의 문자열 값만 반환합니다.</p></blockquote><br><figure class="highlight python"><figcaption><span>python3.8 compress function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compress</span><span class="params">(data, selectors)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (d <span class="keyword">for</span> d, s <span class="keyword">in</span> zip(data, selectors) <span class="keyword">if</span> s)</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>배열에서 첫 번째와 세 번째 인자만 True이므로 a와 c만 반환했습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.compress(<span class="string">'abcd'</span>, [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">a</span></span><br><span class="line"><span class="string">b</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="1-3-dropwhile-🔗"><a href="#1-3-dropwhile-🔗" class="headerlink" title="1.3 dropwhile 🔗 "></a>1.3 dropwhile <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.dropwhile" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="dropwhile"></a></h2><blockquote><p>function과 iterable을 받아서 False 처음 등장하기 전까지는 모두 버리고, 나머지를 반환합니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 dropwhile function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dropwhile</span><span class="params">(predicate, iterable)</span>:</span></span><br><span class="line">    iterable = iter(iterable)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> iterable:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> predicate(x):</span><br><span class="line">            <span class="keyword">yield</span> x</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> iterable:</span><br><span class="line">        <span class="keyword">yield</span> x</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>5번째 인자인 6이 나오기 전까지는 True를 반환하므로 모두 버리고 6과 4만 출력되었습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.dropwhile(<span class="keyword">lambda</span> x: x&lt;<span class="number">5</span>, [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">4</span>]):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">6</span></span><br><span class="line"><span class="string">4</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="1-4-takewhile-🔗"><a href="#1-4-takewhile-🔗" class="headerlink" title="1.4 takewhile 🔗 "></a>1.4 takewhile <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.takewhile" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="takewhile"></a></h2><blockquote><p><code>dropwhile</code>과 반대로 처음 False가 등장할 때까지만 반환합니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 takewhile function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">takewhile</span><span class="params">(predicate, iterable)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> iterable:</span><br><span class="line">        <span class="keyword">if</span> predicate(x):</span><br><span class="line">            <span class="keyword">yield</span> x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>5번째 인자인 6이 나오기 전까지만 True를 반환하므로 6부터 나머지는 반환하지 않습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> it.takewhile(<span class="keyword">lambda</span> x: x&lt;<span class="number">5</span>, [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">4</span>]):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">4</span></span><br><span class="line"><span class="string">3</span></span><br><span class="line"><span class="string">4</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="1-5-groupby-🔗"><a href="#1-5-groupby-🔗" class="headerlink" title="1.5 groupby 🔗 "></a>1.5 groupby <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.groupby" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="groupby"></a></h2><blockquote><p>문자열을 입력받아 연속하여 등장하는 문자열을 그룹으로 묶어서 반환합니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 groupby class</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">groupby</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, iterable, key=None)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            key = <span class="keyword">lambda</span> x: x</span><br><span class="line">        self.keyfunc = key</span><br><span class="line">        self.it = iter(iterable)</span><br><span class="line">        self.tgtkey = self.currkey = self.currvalue = object()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.id = object()</span><br><span class="line">        <span class="keyword">while</span> self.currkey == self.tgtkey:</span><br><span class="line">            self.currvalue = next(self.it)    <span class="comment"># Exit on StopIteration</span></span><br><span class="line">            self.currkey = self.keyfunc(self.currvalue)</span><br><span class="line">        self.tgtkey = self.currkey</span><br><span class="line">        <span class="keyword">return</span> (self.currkey, self._grouper(self.tgtkey, self.id))</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_grouper</span><span class="params">(self, tgtkey, id)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> self.id <span class="keyword">is</span> id <span class="keyword">and</span> self.currkey == tgtkey:</span><br><span class="line">            <span class="keyword">yield</span> self.currvalue</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.currvalue = next(self.it)</span><br><span class="line">            <span class="keyword">except</span> StopIteration:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            self.currkey = self.keyfunc(self.currvalue)</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>groupby()는 각 그룹의 문자열과 해당 문자열이 반복된 리스트를 반환합니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k, g <span class="keyword">in</span> it.groupby(<span class="string">'AAAABBBCCDAABBB'</span>):</span><br><span class="line">    print(k, list(g))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">A ['A', 'A', 'A', 'A']</span></span><br><span class="line"><span class="string">B ['B', 'B', 'B']</span></span><br><span class="line"><span class="string">C ['C', 'C']</span></span><br><span class="line"><span class="string">D ['D']</span></span><br><span class="line"><span class="string">A ['A', 'A']</span></span><br><span class="line"><span class="string">B ['B', 'B', 'B']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="1-6-zip-longest-🔗"><a href="#1-6-zip-longest-🔗" class="headerlink" title="1.6 zip_longest 🔗 "></a>1.6 zip_longest <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.zip_longest" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="zip_longest"></a></h2><blockquote><p>내장함수 zip과 달리 가장 <strong>긴 인자</strong>를 기준으로 zip 연산을 합니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 zip_longest function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zip_longest</span><span class="params">(*args, fillvalue=None)</span>:</span></span><br><span class="line">    iterators = [iter(it) <span class="keyword">for</span> it <span class="keyword">in</span> args]</span><br><span class="line">    num_active = len(iterators)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> num_active:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        values = []</span><br><span class="line">        <span class="keyword">for</span> i, it <span class="keyword">in</span> enumerate(iterators):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                value = next(it)</span><br><span class="line">            <span class="keyword">except</span> StopIteration:</span><br><span class="line">                num_active -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> num_active:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                iterators[i] = repeat(fillvalue)</span><br><span class="line">                value = fillvalue</span><br><span class="line">            values.append(value)</span><br><span class="line">        <span class="keyword">yield</span> tuple(values)</span><br></pre></td></tr></table></figure><p>zip_longest를 예제에 앞서 내장함수 <code>zip</code>에 대해 알아보겠습니다.</p><blockquote><p><code>zip</code>은 길이가 <strong>짧은 인자</strong>를 기준으로 요소들을 결합한 배열을 반환합니다.</p></blockquote><figure class="highlight python"><figcaption><span>'abc'가 'ㄱㄴㄷㄹㅁ' 보다 길이가 짧으므로 'abc' 기준으로 결과가 반환 된 것을 볼 수 있습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">list(zip(<span class="string">'abc'</span>, <span class="string">'ㄱㄴㄷㄹㅁ'</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[('a', 'ㄱ'), ('b', 'ㄴ'), ('c', 'ㄷ')]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>zip_longest는 길이가 긴 'ㄱㄴㄷㄹㅁ'를 기준으로 모자란 부분은 None을 채워서 반환하는 것을 볼 수 있습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">list(it.zip_longest(<span class="string">'abc'</span>, <span class="string">'ㄱㄴㄷㄹㅁ'</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[('a', 'ㄱ'), ('b', 'ㄴ'), ('c', 'ㄷ'), (None, 'ㄹ'), (None, 'ㅁ')]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h1 id="Combinatoric-iterators"><a href="#Combinatoric-iterators" class="headerlink" title="# Combinatoric iterators"></a># Combinatoric iterators</h1><hr><h2 id="2-1-product-🔗"><a href="#2-1-product-🔗" class="headerlink" title="2.1 product 🔗 "></a>2.1 product <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.product" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="product"></a></h2><blockquote><p><code>product</code>는 iterable의 곱집합을 구하는 함수입니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 product function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">product</span><span class="params">(*args, repeat=<span class="number">1</span>)</span>:</span></span><br><span class="line">    pools = [tuple(pool) <span class="keyword">for</span> pool <span class="keyword">in</span> args] * repeat</span><br><span class="line">    result = [[]]</span><br><span class="line">    <span class="keyword">for</span> pool <span class="keyword">in</span> pools:</span><br><span class="line">        result = [x+[y] <span class="keyword">for</span> x <span class="keyword">in</span> result <span class="keyword">for</span> y <span class="keyword">in</span> pool]</span><br><span class="line">    <span class="keyword">for</span> prod <span class="keyword">in</span> result:</span><br><span class="line">        <span class="keyword">yield</span> tuple(prod)</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>'ABCD'와 'xy'의 곱집합인 'Ax Ay Bx By Cx Cy Dx Dy'를 반환하는 예제입니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">list(it.product(<span class="string">'ABCD'</span>, <span class="string">'xy'</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[('A', 'x'),</span></span><br><span class="line"><span class="string"> ('A', 'y'),</span></span><br><span class="line"><span class="string"> ('B', 'x'),</span></span><br><span class="line"><span class="string"> ('B', 'y'),</span></span><br><span class="line"><span class="string"> ('C', 'x'),</span></span><br><span class="line"><span class="string"> ('C', 'y'),</span></span><br><span class="line"><span class="string"> ('D', 'x'),</span></span><br><span class="line"><span class="string"> ('D', 'y')]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>repeat 인자를 넣어주어 다음이 활용할 수도 있습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">list(it.product(range(<span class="number">2</span>), repeat=<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[(0, 0, 0),</span></span><br><span class="line"><span class="string"> (0, 0, 1),</span></span><br><span class="line"><span class="string"> (0, 1, 0),</span></span><br><span class="line"><span class="string"> (0, 1, 1),</span></span><br><span class="line"><span class="string"> (1, 0, 0),</span></span><br><span class="line"><span class="string"> (1, 0, 1),</span></span><br><span class="line"><span class="string"> (1, 1, 0),</span></span><br><span class="line"><span class="string"> (1, 1, 1)]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><p>1과 -1로된 크기가 3인 배열의 경우의 수는 다음과 같습니다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>),</span><br><span class="line"> (<span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>),</span><br><span class="line"> (<span class="number">-1</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>),</span><br><span class="line"> (<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>)]</span><br></pre></td></tr></table></figure><p>위 함수를 <code>product</code>를 이용하면 한줄로 만들 수 있습니다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list(it.product([<span class="number">1</span>, <span class="number">-1</span>], repeat=<span class="number">3</span>))</span><br></pre></td></tr></table></figure><hr><h2 id="2-2-permutations-🔗"><a href="#2-2-permutations-🔗" class="headerlink" title="2.2 permutations 🔗 "></a>2.2 permutations <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.permutations" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="permutations"></a></h2><blockquote><p><code>순열</code>을 뜻하는 <code>permutations</code>은 n개 중에서 r개를 뽑아 만들 수 있는 순서있는 나열입니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 permutations function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permutations</span><span class="params">(iterable, r=None)</span>:</span></span><br><span class="line">    pool = tuple(iterable)</span><br><span class="line">    n = len(pool)</span><br><span class="line">    r = n <span class="keyword">if</span> r <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> r</span><br><span class="line">    <span class="keyword">if</span> r &gt; n:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    indices = list(range(n))</span><br><span class="line">    cycles = list(range(n, n-r, <span class="number">-1</span>))</span><br><span class="line">    <span class="keyword">yield</span> tuple(pool[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices[:r])</span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(r)):</span><br><span class="line">            cycles[i] -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> cycles[i] == <span class="number">0</span>:</span><br><span class="line">                indices[i:] = indices[i+<span class="number">1</span>:] + indices[i:i+<span class="number">1</span>]</span><br><span class="line">                cycles[i] = n - i</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                j = cycles[i]</span><br><span class="line">                indices[i], indices[-j] = indices[-j], indices[i]</span><br><span class="line">                <span class="keyword">yield</span> tuple(pool[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices[:r])</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br></pre></td></tr></table></figure><p>순열의 개수는 다음과 같이 구할 수 있습니다.</p><blockquote><p>nPr = n!/(n-r)!</p></blockquote><figure class="highlight python"><figcaption><span>두 번째 인자는 iterable에서 뽑는 개수이므로 len(iterable) 보다 클 수 없습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">list(it.permutations(<span class="string">'ABCD'</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[('A', 'B'),</span></span><br><span class="line"><span class="string"> ('A', 'C'),</span></span><br><span class="line"><span class="string"> ('A', 'D'),</span></span><br><span class="line"><span class="string"> ('B', 'A'),</span></span><br><span class="line"><span class="string"> ('B', 'C'),</span></span><br><span class="line"><span class="string"> ('B', 'D'),</span></span><br><span class="line"><span class="string"> ('C', 'A'),</span></span><br><span class="line"><span class="string"> ('C', 'B'),</span></span><br><span class="line"><span class="string"> ('C', 'D'),</span></span><br><span class="line"><span class="string"> ('D', 'A'),</span></span><br><span class="line"><span class="string"> ('D', 'B'),</span></span><br><span class="line"><span class="string"> ('D', 'C')]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>r을 생략할 경우 iterable 크기만큼 뽑아서 만들 수 있는 순열을 반환합니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">list(it.permutations(range(<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[(0, 1, 2), (0, 2, 1), (1, 0, 2), (1, 2, 0), (2, 0, 1), (2, 1, 0)]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="2-3-combinations-🔗"><a href="#2-3-combinations-🔗" class="headerlink" title="2.3 combinations 🔗 "></a>2.3 combinations <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.combinations" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="combinations"></a></h2><blockquote><p><code>조합</code>을 의미하는 <code>combinations</code>는 n개 중에서 r를 뽑아 만들 수 있는 집합(set)의 나열입니다. (한 번 뽑은 인자는 다시 뽑을 수 없습니다.)</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 combinations function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">combinations</span><span class="params">(iterable, r)</span>:</span></span><br><span class="line">    pool = tuple(iterable)</span><br><span class="line">    n = len(pool)</span><br><span class="line">    <span class="keyword">if</span> r &gt; n:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    indices = list(range(r))</span><br><span class="line">    <span class="keyword">yield</span> tuple(pool[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(r)):</span><br><span class="line">            <span class="keyword">if</span> indices[i] != i + n - r:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        indices[i] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, r):</span><br><span class="line">            indices[j] = indices[j<span class="number">-1</span>] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">yield</span> tuple(pool[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices)</span><br></pre></td></tr></table></figure><p>조합의 개수는 다음과 같이 구할 수 있습니다.</p><blockquote><p>nCr = nPr/r! = n!/(r!*(n-r)!)</p></blockquote><figure class="highlight python"><figcaption><span>'ABCD' 네 개중에서 순서를 무시하고 2개를 조합하는 방법은 6가지(4C2) 입니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">list(it.combinations(<span class="string">'ABCD'</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[('A', 'B'), ('A', 'C'), ('A', 'D'), ('B', 'C'), ('B', 'D'), ('C', 'D')]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h2 id="2-4-combinations-with-replacement-🔗"><a href="#2-4-combinations-with-replacement-🔗" class="headerlink" title="2.4 combinations_with_replacement 🔗 "></a>2.4 combinations_with_replacement <a href="https://docs.python.org/ko/3.8/library/itertools.html#itertools.combinations_with_replacement" target="_blank" rel="external nofollow noopener noreferrer">🔗</a> <a name="combinations_with_replacement"></a></h2><blockquote><p>위에서 설명한 <code>combinations</code>과 달리 한 번 뽑은 인자를 다시 뽑을 수 있는 경우의 조합입니다.</p></blockquote><figure class="highlight python"><figcaption><span>python3.8 combinations_with_replacement</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pool = tuple(iterable)</span><br><span class="line">n = len(pool)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> n <span class="keyword">and</span> r:</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">indices = [<span class="number">0</span>] * r</span><br><span class="line"><span class="keyword">yield</span> tuple(pool[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(r)):</span><br><span class="line">        <span class="keyword">if</span> indices[i] != n - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    indices[i:] = [indices[i] + <span class="number">1</span>] * (r - i)</span><br><span class="line">    <span class="keyword">yield</span> tuple(pool[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices)</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>'A'를 뽑은 뒤 'A'를 또 뽑을 수 있습니다.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">list(it.combinations_with_replacement(<span class="string">'ABC'</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'B'), ('B', 'C'), ('C', 'C')]</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure><hr><h1 id="결론"><a href="#결론" class="headerlink" title="# 결론"></a># 결론</h1><p>직접 코드로 구현하는데 상당한 시간이 걸리는 함수들을 <code>Itertools</code>를 이용하여 손쉽게 이용할 수 있습니다.<br>본 포스팅에서 설명하지 않은 함수들은 <a href="https://docs.python.org/ko/3.8/library/itertools.html#module-itertools" target="_blank" rel="external nofollow noopener noreferrer">공식문서</a>를 참고하시기 바랍니다.</p>]]></content>
    
    <summary type="html">
    
      &lt;!-- one line summary --&gt;
&lt;h1 id=&quot;Itertools&quot;&gt;&lt;a href=&quot;#Itertools&quot; class=&quot;headerlink&quot; title=&quot;# Itertools&quot;&gt;&lt;/a&gt;# Itertools&lt;/h1&gt;&lt;p&gt;이번 포스팅에서는 Python 2.7과 3.5부터 탑제된 &lt;code&gt;itertools&lt;/code&gt;의 유용하고 자주 쓸만한 함수들을 익혀보도록 하겠습니다.&lt;br&gt;
    
    </summary>
    
    
      <category term="Program Language" scheme="https://nero.devstory.co.kr/categories/Program-Language/"/>
    
    
      <category term="python" scheme="https://nero.devstory.co.kr/tags/python/"/>
    
      <category term="itertools" scheme="https://nero.devstory.co.kr/tags/itertools/"/>
    
  </entry>
  
</feed>
